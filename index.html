<script>
const SHEET_ID = "1ac4JxVWh4eKKZnA_eSMkHe2qxQlucXLtRnVa6COEumQ";
const SHEET_NAME = "Sheet1";
const RANGE = "A1";
const URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}&range=${RANGE}`;

let lastText = "";

async function fetchSheet() {
  try {
    const res = await fetch(URL);
    const csv = await res.text();

    // Parse the CSV: skip header and clean quotes
    const lines = csv.trim().split("\n");
    let message = lines[1] || "";  // Second line is A1
    message = message.replace(/^"|"$/g, ""); // remove quotes if present
    if (!message) message = " "; // fallback if empty
    if (message !== lastText) flipText(message);
    lastText = message;

  } catch (err) {
    document.getElementById("display").textContent = "Error loading sheet!";
    console.error(err);
  }
}

function flipText(msg) {
  const el = document.getElementById("display");
  el.classList.add("flip");
  setTimeout(() => {
    el.textContent = msg;
    el.classList.remove("flip");
  }, 300);
}

fetchSheet();
setInterval(fetchSheet, 10000);
</script>
